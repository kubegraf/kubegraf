{"version":3,"file":"workload-navigation-Cle66AyL.js","sources":["../../src/utils/workload-navigation.ts"],"sourcesContent":["// Copyright 2025 KubeGraf Contributors\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nexport interface WorkloadRef {\n  kind: string; // deployment, statefulset, daemonset, job, cronjob, replicaset\n  name: string;\n  namespace: string;\n  via?: ViaRef[];\n}\n\nexport interface ViaRef {\n  kind: string; // replicaset, job\n  name: string;\n}\n\n/**\n * Returns the abbreviation for a workload kind\n */\nexport function kindAbbrev(kind: string): string {\n  switch (kind.toLowerCase()) {\n    case 'deployment':\n      return 'DEP';\n    case 'statefulset':\n      return 'STS';\n    case 'daemonset':\n      return 'DS';\n    case 'job':\n      return 'JOB';\n    case 'cronjob':\n      return 'CJ';\n    case 'replicaset':\n      return 'RS';\n    default:\n      return kind.toUpperCase().slice(0, 3);\n  }\n}\n\n/**\n * Formats the workload chain for tooltip display\n */\nexport function formatWorkloadChain(ref: WorkloadRef | null | undefined): string {\n  if (!ref) {\n    return 'Unowned';\n  }\n\n  let chain = 'Pod';\n  if (ref.via) {\n    for (const via of ref.via) {\n      chain += ` → ${via.kind} ${via.name}`;\n    }\n  }\n  chain += ` → ${ref.kind} ${ref.name}`;\n  return chain;\n}\n\n/**\n * Returns the URL for a workload detail page\n */\nexport function toWorkloadUrl(ref: WorkloadRef): string {\n  return `/api/workloads/${ref.namespace}/${ref.kind}/${ref.name}`;\n}\n\n/**\n * Returns the view name for a workload kind\n */\nexport function workloadKindToView(kind: string): string {\n  switch (kind.toLowerCase()) {\n    case 'deployment':\n      return 'deployments';\n    case 'statefulset':\n      return 'statefulsets';\n    case 'daemonset':\n      return 'daemonsets';\n    case 'job':\n      return 'jobs';\n    case 'cronjob':\n      return 'cronjobs';\n    case 'replicaset':\n      return 'deployments'; // ReplicaSets are shown in Deployments view\n    default:\n      return 'pods';\n  }\n}\n\n/**\n * Builds filter parameters for Pods list based on workload reference\n */\nexport function buildPodFiltersFromWorkload(ref: WorkloadRef): {\n  ownerKind?: string;\n  ownerName?: string;\n  namespace?: string;\n} {\n  return {\n    ownerKind: ref.kind,\n    ownerName: ref.name,\n    namespace: ref.namespace,\n  };\n}\n\n/**\n * Builds query string for Pods list filtering\n */\nexport function buildPodFilterQuery(ref: WorkloadRef): string {\n  const params = buildPodFiltersFromWorkload(ref);\n  const queryParams = new URLSearchParams();\n  if (params.ownerKind) queryParams.set('ownerKind', params.ownerKind);\n  if (params.ownerName) queryParams.set('ownerName', params.ownerName);\n  if (params.namespace) queryParams.set('namespace', params.namespace);\n  return queryParams.toString();\n}\n\n/**\n * Builds navigation URL with focus parameter for workload detail pages\n * This allows navigation to a specific resource with automatic focus/highlight\n */\nexport function buildWorkloadFocusUrl(ref: WorkloadRef): string {\n  const view = workloadKindToView(ref.kind);\n  const params = new URLSearchParams();\n  if (ref.namespace) params.set('namespace', ref.namespace);\n  params.set('focus', ref.name);\n  return `?${params.toString()}`;\n}\n\n/**\n * Navigates to a workload view with focus on a specific resource\n * Updates the URL and view state\n * @param returnView - Optional view to return to when modal closes (e.g., 'pods')\n */\nexport function navigateToWorkloadWithFocus(\n  ref: WorkloadRef,\n  setCurrentView: (view: string) => void,\n  returnView?: string\n): void {\n  const view = workloadKindToView(ref.kind);\n  const focusUrl = buildWorkloadFocusUrl(ref);\n  \n  // Update URL with focus params\n  const currentUrl = new URL(window.location.href);\n  const newParams = new URLSearchParams();\n  if (ref.namespace) newParams.set('namespace', ref.namespace);\n  newParams.set('focus', ref.name);\n  \n  // Store return view in URL if provided\n  if (returnView) {\n    newParams.set('returnView', returnView);\n  }\n  \n  // Preserve other query params if needed\n  currentUrl.search = newParams.toString();\n  window.history.pushState({}, '', currentUrl.toString());\n  \n  // Navigate to the view\n  setCurrentView(view as any);\n}\n\n"],"names":[],"mappings":"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"}